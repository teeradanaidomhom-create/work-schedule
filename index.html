<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏á‡∏≤‡∏ô‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</title>
    <style>
        body {
            font-family: 'Tahoma', sans-serif;
            background-color: #f4f7f6;
            text-align: center;
            padding: 20px;
        }

        .container {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            max-width: 550px;
            margin: auto;
        }

        input {
            padding: 12px;
            width: 80%;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin-bottom: 15px;
            font-size: 16px;
        }

        button {
            background-color: #27ae60;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: 0.3s;
        }

        button:hover {
            background-color: #219150;
        }

        .result-card {
            margin-top: 20px;
            text-align: left;
            padding: 20px;
            border-left: 5px solid #27ae60;
            background: #f9f9f9;
            display: none;
        }

        .schedule-row {
            margin-bottom: 8px;
            border-bottom: 1px solid #eee;
            padding-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .date-label {
            color: #555;
            font-size: 14px;
        }

        .work-time {
            color: #27ae60;
            font-weight: bold;
        }

        .day-off {
            color: #e67e22;
            font-weight: bold;
        }

        h2 {
            color: #2c3e50;
        }
    </style>
</head>

<body>
    <div class="container">
        <h2>üîç ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î</h2>
        <input type="text" id="empName" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì (‡πÄ‡∏ä‡πà‡∏ô ‡πÅ‡∏û‡∏£)...">
        <br>
        <button onclick="searchHoliday()">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏á‡∏≤‡∏ô</button>
        <div id="result" class="result-card">
            <h3 id="showName"
                style="color: #2c3e50; border-bottom: 2px solid #27ae60; padding-bottom: 10px; margin-top: 0;"></h3>
            <div id="scheduleContainer"></div>
        </div>
    </div>

    <script>
        async function searchHoliday() {
            const inputName = document.getElementById('empName').value.trim();
            const url = 'https://api.sheety.co/56e760a761d018c5ad7458c87a819a1b/myDatabase/sheet1';
            if (!inputName) { alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ñ‡∏£‡∏±‡∏ö'); return; }

            try {
                const response = await fetch(url);
                const data = await response.json();

                // 1. ‡∏´‡∏≤‡πÅ‡∏ñ‡∏ß‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô: ‡∏Å‡∏ß‡∏≤‡∏î‡∏´‡∏≤‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏≠‡∏á ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ "‡πÅ‡∏û‡∏£" ‡πÄ‡∏≠‡∏≤‡πÅ‡∏ñ‡∏ß‡∏ô‡∏±‡πâ‡∏ô‡∏°‡∏≤‡πÄ‡∏•‡∏¢
                const staff = data.sheet1.find(row =>
                    Object.values(row).some(val => val && val.toString().trim() === inputName)
                );

                if (staff) {
                    document.getElementById('result').style.display = 'block';
                    document.getElementById('showName').innerText = '‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì ' + inputName;

                    // 2. ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÑ‡∏ß‡πâ‡πÇ‡∏ä‡∏ß‡πå
                    const dateLabels = [
                        "‡∏ß‡∏±‡∏ô‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå 29/12/2025", "‡∏ß‡∏±‡∏ô‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£ 30/12/2025", "‡∏ß‡∏±‡∏ô‡∏û‡∏∏‡∏ò 31/12/2025",
                        "‡∏ß‡∏±‡∏ô‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ 1/1/2026", "‡∏ß‡∏±‡∏ô‡∏®‡∏∏‡∏Å‡∏£‡πå 2/1/2026", "‡∏ß‡∏±‡∏ô‡πÄ‡∏™‡∏≤‡∏£‡πå 3/1/2026", "‡∏ß‡∏±‡∏ô‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå 4/1/2026"
                    ];

                    let htmlOutput = '';

                    // 3. ‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö (‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå D ‡∏ñ‡∏∂‡∏á J ‡πÉ‡∏ô Google Sheets)
                    // Sheety ‡∏à‡∏∞‡∏Ç‡πâ‡∏≤‡∏°‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÅ‡∏£‡∏Å‡πÜ ‡πÑ‡∏õ ‡∏î‡∏±‡∏á‡∏ô‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏ô‡∏±‡∏ö‡∏à‡∏≤‡∏Å Property ‡∏ó‡∏µ‡πà 3 ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏ô‡πÑ‡∏õ
                    const allValues = Object.values(staff);
                    // ‡∏ï‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô (id, ‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô, ‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô, ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô) ‡∏≠‡∏≠‡∏Å‡πÑ‡∏õ
                    const timeValues = allValues.slice(3);

                    dateLabels.forEach((label, index) => {
                        let value = timeValues[index] ? timeValues[index].toString().trim() : '';
                        let displayValue = value || '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';

                        // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡∏µ
                        let isHoliday = ['‡∏û‡∏±‡∏Å‡∏£‡πâ‡∏≠‡∏ô', 'Day Off', '‡∏•‡∏≤‡∏Å‡∏¥‡∏à', '‡∏•‡∏≤‡∏õ‡πà‡∏ß‡∏¢'].some(status => displayValue.includes(status));
                        let cssClass = isHoliday ? 'day-off' : (displayValue === '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•' ? '' : 'work-time');

                        htmlOutput += `
                        <div class="schedule-row">
                            <span class="date-label">${label}</span>
                            <span class="${cssClass}">${displayValue}</span>
                        </div>`;
                    });

                    document.getElementById('scheduleContainer').innerHTML = htmlOutput;
                } else {
                    alert('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ä‡∏∑‡πà‡∏≠ "' + inputName + '" ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏£‡∏±‡∏ö');
                }
            } catch (error) {
                console.error('Error:', error);
                alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•');
            }
        }
    </script>
</body>

</html>